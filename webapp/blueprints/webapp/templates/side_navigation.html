{#
Map of navigation items -> its "route" within webapp blueprint
Requires the styles.css file
#}
{% block stylesheets %}
<link rel="stylesheet" href="{{ url_for('webapp.static',filename='styles/navBar.css') }}"/>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('webapp.static', filename='scripts/navbarHandler.js') }}" defer></script>
{% endblock %}
{% set navTabs = [{"name":"Settings","route":"settings"}] %}
{% set conversation_id = request.path.split("/")[-1] | int %}

<button id="toggleNav" class="btn toggle-btn">â€¹</button>

<nav id="navBar" class="nav-container">

    <div id="sidebarButtonsContainer">
        <div id="newChatButtonPlaceholder"></div>
        <button id="newChatButton" onclick="window.location.href='{{ url_for('webapp.chat.new') }}'"
                class="btn new-chat-btn">+
        </button>
    </div>
    <ul>
        {% for tab in navTabs %}
        <li class="nav-item {{ 'active' if request.endpoint == ('webapp.' + tab['route']) else '' }}">
            <a href="{{ url_for('webapp.' + tab['route']) }}">
                <div>{{ tab["name"] }}</div>
            </a>
        </li>
        {% endfor %}
    </ul>
    <div class="chat-history">
        <ul id="chatList">
            {% for conv in conversations %}
            <li class="flex-row nav-item {{ " active
            " if request.endpoint == 'webapp.chat.index' and conversation_id == conv.id else "" }}">
            {# Make sure this link goes somewhere, e.g., /chat/{{ chat.id }} #}
            <a class="flex-1"
               href="{{ url_for('webapp.chat.index',conversation_id=conv.id) }}">{{ conv.title }}</a>
            <button class="btn-icon" data-conversation-id="{{ conv.id }}" onclick="toggleMenu(event)">
                <img src="{{ url_for('webapp.static',filename='icons/view_more.svg') }}"
                     aria-label="Expand submenu"
                     alt="" width="16" height="16">
            </button>
            </li>
            {% endfor %}
        </ul>
    </div>

    {# --- Context Menu for Conversations --- #}
    <div id="conversationContextMenu" class="conversation-context-menu">
        <a class="btn-icon conversation-context-entry delete"
           href="{{ url_for('webapp.chat.delete',current_conversation_id=conversation_id,to_delete_id=-1) }}">
            <span>Delete </span>
            <img src="{{ url_for('webapp.static',filename='icons/trashcan.svg') }}" aria-label="Delete conversation"
            alt="" width="16" height="16">
        </a>
    </div>

</nav>
